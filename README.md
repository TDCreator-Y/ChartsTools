# ChartsTools - 矩阵热力图可视化工具

一个基于 PyQt6 和 ECharts 的专业矩阵热力图可视化工具，专为教学和数据分析设计。

（如果有需要升级优化可以联系我）
![示例图片](https://github.com/TDCreator-Y/ChartsTools/blob/main/images/test.png?raw=true)
## 功能特点

🔥 **矩阵热力图可视化** - 支持多种数据类型的热力图生成  
📊 **多种数据格式** - 支持 CSV、Excel 文件导入  
🎨 **多种颜色方案** - 内置15种专业配色方案 + 自定义颜色编辑  
⚙️ **实时配置面板** - 60+ 配置项实时调整图表参数  
💻 **完整代码预览** - 显示完整的 HTML/CSS/JavaScript 代码  
🖥️ **现代化界面** - 采用现代卡片式设计，支持主题切换  
📱 **响应式布局** - 适配不同屏幕尺寸  
🔧 **完全离线** - 无需网络连接，本地化运行  
✨ **样式一致性** - 所有数据源使用统一的样式渲染  

## 最新功能 (v1.2.1) - 启动体验优化版本

### ✨ 启动画面增强 (v1.2.1)
- **专业启动画面**: 添加了现代化的启动画面，显示加载进度
- **启动状态提示**: 实时显示应用初始化状态
- **用户体验提升**: 解决启动时间长导致用户误以为软件无响应的问题
- **视觉设计改进**: 采用现代深色主题设计，与应用界面保持一致

### 🎯 文件导入数据样式一致性修复 (v1.2.0)

### 🎯 文件导入数据样式一致性修复
- **统一样式渲染**: 修复了CSV/Excel导入数据与模拟数据样式不一致的问题
- **配置状态保持**: 修复了点击配置项自动切回模拟数据的问题
- **颜色方案同步**: 导入数据的颜色方案与UI配置面板完全同步
- **兼容性增强**: 改进了不同数据类型的处理逻辑

### 🎛️ 配置面板系统 (持续优化)
- **基础配置**: 图表标题、网格布局、坐标轴样式
- **样式配置**: 颜色方案、视觉映射、数据标签、单元格样式  
- **交互配置**: 提示框、缩放功能、工具箱
- **动画配置**: 动画开关、持续时间、缓动效果
- **高级配置**: 渲染模式、性能优化、无障碍支持

### 🎨 颜色方案增强
- **15种预设方案**: 蓝色渐变、红色渐变、绿色渐变等专业配色
- **自定义颜色编辑**: 支持完全自定义的颜色方案创建
- **颜色预览功能**: 实时预览颜色方案效果
- **智能色彩搭配**: 根据数据特性推荐最佳颜色方案

## 核心功能

### 📊 数据导入与处理
- **CSV 文件支持**: 自动识别分隔符和编码格式
- **Excel 文件支持**: 支持 .xlsx 和 .xls 格式，自动读取工作表
- **模拟数据生成**: 内置5种不同场景的示例数据
- **数据预处理**: 自动处理缺失值和格式转换

### 🎨 可视化定制
- **多种热力图模式**: 支持数值型、分类型数据可视化
- **颜色映射控制**: 线性/分段映射、自定义数值范围
- **视觉元素配置**: 网格线、坐标轴、标签样式完全可控
- **交互功能**: 缩放、平移、数据提示等丰富交互

## 快速开始

### 环境要求

- Python 3.8+
- Windows 10/11 (主要测试平台)
- 2GB+ 内存
- 50MB+ 磁盘空间

### 安装步骤

1. **克隆项目**
   ```bash
   git clone https://github.com/TDCreator-Y/ChartsTools.git
   cd ChartsTools
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **启动应用**
   ```bash
   python main.py
   ```
   
   或者使用快速启动脚本：
   ```bash
   start_dev.bat
   ```

### 依赖包说明

- **PyQt6**: 现代化 GUI 框架
- **pandas**: 数据处理和分析
- **numpy**: 数值计算
- **openpyxl**: Excel 文件支持

## 使用指南

### 基本操作

1. **选择数据类型**
   - 学科成绩相关性 (6×6)
   - 服务器负载数据 (5×6)
   - 机房温度分布 (8×8)
   - 网络延迟矩阵 (6×6)
   - 销售数据热力图 (12×5)

2. **导入自定义数据**
   - 点击"导入CSV"或"导入Excel"按钮
   - 选择数据文件
   - 自动生成热力图

3. **实时配置调整**
   - 使用右侧配置面板调整图表参数
   - 修改后图表立即更新
   - 支持标题、网格、坐标轴、颜色等配置

4. **查看代码**
   - 在"HTML代码预览"面板中查看完整代码
   - 包含完整的 HTML、CSS 和 JavaScript
   - 配置参数变化会实时更新代码

5. **主题切换**
   - 使用主题切换按钮在浅色和深色主题间切换

## 项目结构

```
ChartsTools/
├── main.py                    # 程序入口
├── requirements.txt           # 依赖包列表
├── start_dev.bat             # 快速启动脚本
├── README.md                 # 项目说明
├── CHANGELOG.md              # 开发日志
├── LICENSE                   # 许可证文件
├── src/                      # 源代码
│   ├── ui/main_window.py     # 主窗口实现
│   ├── core/                 # 核心功能模块
│   │   ├── app_controller.py # 应用控制器
│   │   ├── data_manager.py   # 数据管理器
│   │   ├── chart_renderer.py # 图表渲染器
│   │   └── code_generator.py # 代码生成器
│   └── utils/                # 工具模块
├── config/                   # 配置文件
│   └── theme_settings.json   # 主题配置
├── resources/                # 资源文件
│   ├── js/echarts.min.js     # ECharts 库
│   └── styles/               # 样式文件
│       ├── light_theme.qss   # 浅色主题
│       └── dark_theme.qss    # 深色主题
├── examples/                 # 示例数据
│   ├── README.md             # 示例数据说明
│   └── *.csv                 # 各种示例数据文件
└── tests/                    # 测试文件
```

## 技术架构

### 核心技术栈

- **前端**: PyQt6 WebEngineView
- **图表引擎**: ECharts 5.4.0
- **数据处理**: Pandas + NumPy
- **界面设计**: 现代卡片式布局

### 关键特性

1. **本地 ECharts 集成**
   - 解决了 WebEngine 本地文件加载问题
   - 嵌入式脚本加载，完全离线运行

2. **配置面板联动系统**
   - 实时参数调整和图表更新
   - 60+ 配置项支持
   - 配置状态保存和恢复

3. **文件导入系统**
   - 统一的文件处理流程
   - 支持多种数据格式
   - 自动数据类型检测

4. **代码预览功能**
   - 完整的 HTML 代码显示
   - 包含所有 CSS 和 JavaScript
   - 配置参数实时反映到代码

## 常见问题

### Q: 程序无法启动？
A: 请检查 Python 版本(3.8+)和依赖包是否正确安装。

### Q: 热力图不显示？
A: 确保 ECharts 文件存在于 `resources/js/echarts.min.js`。

### Q: 配置面板修改后图表不更新？
A: 这个问题在 v1.2.0 版本中已经修复，请确保使用最新版本。

### Q: 导入文件后样式不一致？
A: v1.2.0 版本已修复此问题，现在所有数据源都使用统一样式。

### Q: 如何自定义更多配置项？
A: 可以在 `src/ui/main_window.py` 中添加新的配置控件和处理逻辑。

## 贡献指南

欢迎贡献代码！请遵循以下流程：

1. Fork 项目
2. 创建特性分支
3. 提交代码
4. 发起 Pull Request

## 许可证

本项目采用 MIT 许可证。详见 LICENSE 文件。

## 联系方式

如有问题或建议，请通过以下方式联系：

- 创建 GitHub Issue
- 项目仓库: https://github.com/TDCreator-Y/ChartsTools
- QQ：3014863607

## 致谢

感谢以下开源项目：
- [ECharts](https://echarts.apache.org/) - 优秀的图表库
- [PyQt6](https://www.riverbankcomputing.com/software/pyqt/) - 强大的 GUI 框架
- [Pandas](https://pandas.pydata.org/) - 数据分析利器

---

**项目状态**: 生产就绪  
**最后更新**: 2025-08-04 
**当前版本**: v1.7.0
