# ChartsTools - 矩阵热力图可视化工具

一个基于 PyQt6 和 ECharts 的专业矩阵热力图可视化工具，专为教学和数据分析设计。

## 功能特点

🔥 **矩阵热力图可视化** - 支持多种数据类型的热力图生成  
📊 **多种数据格式** - 支持 CSV、Excel 文件导入  
🎨 **多种颜色方案** - 内置多种专业配色方案  
⚙️ **实时配置面板** - 60+ 配置项实时调整图表参数  
💻 **完整代码预览** - 显示完整的 HTML/CSS/JavaScript 代码  
🖥️ **现代化界面** - 采用现代卡片式设计，支持主题切换  
📱 **响应式布局** - 适配不同屏幕尺寸  
🔧 **完全离线** - 无需网络连接，本地化运行  

## 最新功能 (v1.1.0)

### 🎛️ 配置面板联动功能
- **基础配置**: 图表标题、网格布局、坐标轴样式
- **样式配置**: 颜色方案、视觉映射、数据标签
- **动画配置**: 动画开关、持续时间、缓动效果
- **高级配置**: 渲染模式、工具箱、性能优化

### 📊 实时参数调整
- 配置面板参数修改后图表立即更新
- 支持60+ 配置项的实时调整
- 配置状态自动保存和恢复

## 快速开始

### 环境要求

- Python 3.8+
- Windows 10/11 (主要测试平台)
- 2GB+ 内存
- 50MB+ 磁盘空间

### 安装步骤

1. **克隆项目**
   ```bash
   git clone https://github.com/TDCreator-Y/ChartsTools.git
   cd ChartsTools
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **启动应用**
   ```bash
   python main.py
   ```
   
   或者使用快速启动脚本：
   ```bash
   start_dev.bat
   ```

### 依赖包说明

- **PyQt6**: 现代化 GUI 框架
- **pandas**: 数据处理和分析
- **numpy**: 数值计算
- **openpyxl**: Excel 文件支持

## 使用指南

### 基本操作

1. **选择数据类型**
   - 相关性矩阵 (5×5)
   - 随机数据 (6×6)
   - 模式数据 (7×7)

2. **导入自定义数据**
   - 点击"导入CSV"或"导入Excel"按钮
   - 选择数据文件
   - 自动生成热力图

3. **实时配置调整**
   - 使用右侧配置面板调整图表参数
   - 修改后图表立即更新
   - 支持标题、网格、坐标轴、颜色等配置

4. **查看代码**
   - 在"HTML代码预览"面板中查看完整代码
   - 包含完整的 HTML、CSS 和 JavaScript
   - 配置参数变化会实时更新代码

5. **主题切换**
   - 使用主题切换按钮在浅色和深色主题间切换

### 配置面板使用

#### 基础配置
- **图表标题**: 显示/隐藏、文本内容、位置、字体样式
- **网格布局**: 图表高度、边距设置
- **坐标轴**: 标签显示、字体大小、颜色、旋转角度

#### 样式配置
- **颜色方案**: 蓝色、红色、绿色、彩虹渐变
- **视觉映射**: 颜色条显示、方向、位置、尺寸
- **数据标签**: 字体大小、颜色、格式化
- **单元格样式**: 边框、圆角、透明度

#### 交互配置
- **提示框**: 启用/禁用、格式化字符串
- **缩放功能**: 数据缩放控件

#### 动画配置
- **动画开关**: 启用/禁用动画效果
- **持续时间**: 动画播放时长
- **缓动效果**: 动画缓动函数

#### 高级配置
- **渲染模式**: Canvas/SVG 渲染器选择
- **工具箱**: 保存图片、数据视图、还原功能
- **性能优化**: 大数据优化、采样方法
- **无障碍支持**: 辅助功能标签和描述

### 支持的数据格式

#### CSV 文件格式
```csv
,A,B,C,D
A,1.0,0.5,0.3,0.1
B,0.5,1.0,0.7,0.2
C,0.3,0.7,1.0,0.8
D,0.1,0.2,0.8,1.0
```

#### Excel 文件格式
- 支持 .xlsx 和 .xls 格式
- 读取第一个工作表
- 第一行作为列标题，第一列作为行标题

### 示例数据

项目包含多个示例数据文件，位于 `examples/` 目录：

- `机房温度分布数据.csv` - 8×8 温度矩阵
- `网络延迟矩阵.csv` - 6×6 对称矩阵
- `服务器负载数据.csv` - 5×6 负载矩阵
- `学科成绩相关性.csv` - 6×6 相关性矩阵
- `销售数据热力图.csv` - 12×5 销售数据

## 项目结构

```
ChartsTools/
├── main.py                    # 程序入口
├── requirements.txt           # 依赖包列表
├── start_dev.bat             # 快速启动脚本
├── README.md                 # 项目说明（本文件）
├── CHANGELOG.md              # 开发日志
├── LICENSE                   # 许可证文件
├── src/                      # 源代码
│   ├── ui/main_window.py     # 主窗口实现
│   ├── core/                 # 核心功能模块
│   │   ├── app_controller.py # 应用控制器
│   │   ├── data_manager.py   # 数据管理器
│   │   ├── chart_renderer.py # 图表渲染器
│   │   └── code_generator.py # 代码生成器
│   └── utils/                # 工具模块
│       └── config_manager.py # 配置管理器
├── config/                   # 配置文件
│   └── theme_settings.json   # 主题配置
├── resources/                # 资源文件
│   ├── js/echarts.min.js     # ECharts 库
│   └── styles/               # 样式文件
│       ├── light_theme.qss   # 浅色主题
│       └── dark_theme.qss    # 深色主题
├── examples/                 # 示例数据
│   ├── README.md             # 示例数据说明
│   └── *.csv                 # 各种示例数据文件
└── tests/                    # 测试文件
    └── __init__.py
```

## 技术架构

### 核心技术栈

- **前端**: PyQt6 WebEngineView
- **图表引擎**: ECharts 5.4.0
- **数据处理**: Pandas + NumPy
- **界面设计**: 现代卡片式布局

### 关键特性

1. **本地 ECharts 集成**
   - 解决了 WebEngine 本地文件加载问题
   - 嵌入式脚本加载，完全离线运行

2. **配置面板联动系统**
   - 实时参数调整和图表更新
   - 60+ 配置项支持
   - 配置状态保存和恢复

3. **文件导入系统**
   - 统一的文件处理流程
   - 支持多种数据格式
   - 自动数据类型检测

4. **代码预览功能**
   - 完整的 HTML 代码显示
   - 包含所有 CSS 和 JavaScript
   - 配置参数实时反映到代码

## 常见问题

### Q: 程序无法启动？
A: 请检查 Python 版本(3.8+)和依赖包是否正确安装。

### Q: 热力图不显示？
A: 确保 ECharts 文件存在于 `resources/js/echarts.min.js`。

### Q: 配置面板修改后图表不更新？
A: 这个问题在 v1.1.0 版本中已经修复，请确保使用最新版本。

### Q: 导入文件后没有变化？
A: 检查文件格式是否正确，确保数据为数值型。

### Q: 如何自定义更多配置项？
A: 可以在 `src/ui/main_window.py` 中添加新的配置控件和处理逻辑。

## 开发说明

### 开发环境设置

1. 克隆项目到本地
2. 创建虚拟环境（推荐）
3. 安装开发依赖
4. 使用 IDE 打开项目

### 代码规范

- 使用 Python 3.8+ 语法
- 遵循 PEP 8 编码规范
- 函数和类添加详细注释
- 模块化设计，保持代码清晰

### 扩展配置项

要添加新的配置项，需要：
1. 在相应的配置选项卡中添加UI控件
2. 在 `_get_current_config()` 方法中添加配置读取逻辑
3. 在 `_build_echarts_config_from_ui()` 方法中添加ECharts配置映射
4. 连接控件信号到 `on_config_changed()` 方法

## 贡献指南

欢迎贡献代码！请遵循以下流程：

1. Fork 项目
2. 创建特性分支
3. 提交代码
4. 发起 Pull Request

## 许可证

本项目采用 MIT 许可证。详见 LICENSE 文件。

## 联系方式

如有问题或建议，请通过以下方式联系：

- 创建 GitHub Issue
- 项目仓库: https://github.com/TDCreator-Y/ChartsTools

## 致谢

感谢以下开源项目：
- [ECharts](https://echarts.apache.org/) - 优秀的图表库
- [PyQt6](https://www.riverbankcomputing.com/software/pyqt/) - 强大的 GUI 框架
- [Pandas](https://pandas.pydata.org/) - 数据分析利器

---

**项目状态**: 生产就绪  
**最后更新**: 2024-12-19  
**当前版本**: v1.1.0 